<!DOCTYPE html><html lang="en"><head>
  <meta charset="utf-8">
  <title>[RxJS] 實戰練習 - 自動完成 / 搜尋 / 排序 / 分頁 | 全端開發人員天梯</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <style type="text/css">@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF;}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu72xKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu5mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0370-03FF;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7GxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4mxKKTU1Kg.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF;}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}</style>
  <style type="text/css">@font-face{font-family:'Lato';font-style:italic;font-weight:300;src:url(https://fonts.gstatic.com/s/lato/v20/S6u_w4BMUTPHjxsI9w2_FQftx9897sxZ.woff2) format('woff2');unicode-range:U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}@font-face{font-family:'Lato';font-style:italic;font-weight:300;src:url(https://fonts.gstatic.com/s/lato/v20/S6u_w4BMUTPHjxsI9w2_Gwftx9897g.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}@font-face{font-family:'Lato';font-style:italic;font-weight:400;src:url(https://fonts.gstatic.com/s/lato/v20/S6u8w4BMUTPHjxsAUi-qNiXg7eU0.woff2) format('woff2');unicode-range:U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}@font-face{font-family:'Lato';font-style:italic;font-weight:400;src:url(https://fonts.gstatic.com/s/lato/v20/S6u8w4BMUTPHjxsAXC-qNiXg7Q.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}@font-face{font-family:'Lato';font-style:italic;font-weight:700;src:url(https://fonts.gstatic.com/s/lato/v20/S6u_w4BMUTPHjxsI5wq_FQftx9897sxZ.woff2) format('woff2');unicode-range:U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}@font-face{font-family:'Lato';font-style:italic;font-weight:700;src:url(https://fonts.gstatic.com/s/lato/v20/S6u_w4BMUTPHjxsI5wq_Gwftx9897g.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}@font-face{font-family:'Lato';font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/lato/v20/S6u9w4BMUTPHh7USSwaPGQ3q5d0N7w.woff2) format('woff2');unicode-range:U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}@font-face{font-family:'Lato';font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/lato/v20/S6u9w4BMUTPHh7USSwiPGQ3q5d0.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}@font-face{font-family:'Lato';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/lato/v20/S6uyw4BMUTPHjxAwXiWtFCfQ7A.woff2) format('woff2');unicode-range:U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}@font-face{font-family:'Lato';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/lato/v20/S6uyw4BMUTPHjx4wXiWtFCc.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}@font-face{font-family:'Lato';font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/lato/v20/S6u9w4BMUTPHh6UVSwaPGQ3q5d0N7w.woff2) format('woff2');unicode-range:U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}@font-face{font-family:'Lato';font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/lato/v20/S6u9w4BMUTPHh6UVSwiPGQ3q5d0.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}</style>
  <style type="text/css">@font-face{font-family:'Material Icons';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/materialicons/v111/flUhRq6tzZclQEJ-Vdg-IuiaDsNcIhQ8tQ.woff2) format('woff2');}.material-icons{font-family:'Material Icons';font-weight:normal;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-feature-settings:'liga';-webkit-font-smoothing:antialiased;}</style>
  <script src="https://kit.fontawesome.com/1792a2a12b.js" crossorigin="anonymous"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/github.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js"></script>
  <script async="" defer="" crossorigin="anonymous" src="https://connect.facebook.net/zh_TW/sdk.js#xfbml=1&amp;version=v3.3&amp;appId=1148471878668114&amp;autoLogAppEvents=1"></script>
<style>body,html{height:100%;background:#fafafa;}body{margin:0;font-family:Roboto,loto,noto sans tc,microsoft yahei,sans-serif;}</style><style>.mat-fab,.mat-icon-button{font-family:Roboto,Helvetica Neue,sans-serif;font-size:14px;font-weight:500;}.mat-chip{font-size:14px;font-weight:500;}.mat-toolbar,.mat-toolbar h1{font:500 20px/32px Roboto,Helvetica Neue,sans-serif;letter-spacing:normal;margin:0;}.mat-list-item{font-family:Roboto,Helvetica Neue,sans-serif;}.mat-list-base .mat-list-item{font-size:16px;}.mat-ripple{overflow:hidden;position:relative;}.mat-ripple:not(:empty){transform:translateZ(0);}.cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;}.mat-focus-indicator{position:relative;}.mat-elevation-z6{box-shadow:0 3px 5px -1px #0003,0 6px 10px 0 #00000024,0 1px 18px 0 #0000001f;}.mat-icon-button{color:inherit;background:#0000;}.mat-button-focus-overlay{background:#000;}.mat-fab{color:#000000de;background-color:#fff;}.mat-fab:not([class*=mat-elevation-z]){box-shadow:0 3px 5px -1px #0003,0 6px 10px 0 #00000024,0 1px 18px 0 #0000001f;}.mat-fab:not(.mat-button-disabled):active:not([class*=mat-elevation-z]){box-shadow:0 7px 8px -4px #0003,0 12px 17px 2px #00000024,0 5px 22px 4px #0000001f;}.mat-chip.mat-standard-chip{background-color:#e0e0e0;color:#000000de;}.mat-chip.mat-standard-chip:not(.mat-chip-disabled):active{box-shadow:0 3px 3px -2px #0003,0 3px 4px 0 #00000024,0 1px 8px 0 #0000001f;}.mat-chip.mat-standard-chip:after{background:#000;}.mat-chip.mat-standard-chip.mat-chip-selected.mat-primary{background-color:#3f51b5;color:#fff;}.mat-divider{border-top-color:#0000001f;}.mat-list-base .mat-list-item{color:#000000de;}.mat-nav-list .mat-list-item:focus,.mat-nav-list .mat-list-item:hover{background:#0000000a;}.mat-drawer-container{background-color:#fafafa;color:#000000de;}.mat-drawer{color:#000000de;}.mat-drawer{background-color:#fff;}.mat-drawer-side{border-right:1px solid #0000001f;}.mat-toolbar{background:#f5f5f5;color:#000000de;}.mat-toolbar.mat-primary{background:#3f51b5;color:#fff;}.mat-toolbar-single-row{height:64px;}@media (max-width: 599px){.mat-toolbar-single-row{height:56px;}}body,html{height:100%;background:#fafafa;}body{margin:0;font-family:Roboto,loto,noto sans tc,microsoft yahei,sans-serif;}a{color:#5c6bc0;transition:all .3s;}a,a:hover{text-decoration:underline;}a:hover{color:#3949ab;}a:active{color:#5c6bc0;}.blog-post{margin-bottom:16px;}.blog-post .blog-post-subtitle{display:flex;align-items:center;font-size:14px;}.blog-post .blog-post-subtitle .sub-divider{margin:0 8px;}.blog-post .blog-post-subtitle .mat-icon{margin-right:8px;position:relative;top:-2px;}.blog-post .blog-post-subtitle .blog-post-published{line-height:24px;display:inline-flex;flex-direction:row;align-items:center;}.blog-post .blog-post-subtitle .blog-post-categories{margin-left:8px;line-height:24px;display:inline-flex;}.blog-post .blog-post-subtitle .blog-post-categories .blog-post-category-link{font-weight:500;}.blog-post .blog-post{font-size:16px;line-height:24px;color:#212121;}.blog-post{font-size:16px;line-height:24px;}.blog-post img{max-width:100%;border:.5px solid #0003;display:block;margin:0 auto;}.blog-post pre{font-size:14px;line-height:21px;background:#eee;border:.5px solid #0003;border-radius:5px;display:block;margin:16px auto;overflow-x:auto;white-space:pre-wrap;}.blog-post code{background:#eee;border-radius:3px;padding:3px;}.blog-post .note{background:#0000;border:.5px solid #0003;border-radius:3px;padding:1em;}.blog-post .note p:first-child{margin-block-start:0;}.blog-post .note p:last-child{margin-block-end:0;}.blog-post .note.info{border-left:5px solid #3f51b5;}.blog-post-tags{display:flex;justify-content:center;}.blog-post-tags .blog-post-tag{cursor:pointer;}</style><link rel="stylesheet" href="styles.876ba2c12bf128be887b.css" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="styles.876ba2c12bf128be887b.css"></noscript><style ng-transition="serverApp">.toolbar[_ngcontent-sc86]{position:fixed;z-index:10}.toolbar[_ngcontent-sc86]   a.header-link[_ngcontent-sc86]{text-decoration:none}.toolbar[_ngcontent-sc86]   a.header-link[_ngcontent-sc86]   .header-link-1[_ngcontent-sc86]{color:#fff}.toolbar[_ngcontent-sc86]   a.header-link[_ngcontent-sc86]   .header-link-1[_ngcontent-sc86]:hover, .toolbar[_ngcontent-sc86]   a.header-link[_ngcontent-sc86]   .header-link-1[_ngcontent-sc86]:active{color:#fff}.toolbar[_ngcontent-sc86]   a.header-link[_ngcontent-sc86]   .header-link-2[_ngcontent-sc86]{color:#fff}.toolbar[_ngcontent-sc86]   a.header-link[_ngcontent-sc86]   .header-link-2[_ngcontent-sc86]:hover, .toolbar[_ngcontent-sc86]   a.header-link[_ngcontent-sc86]   .header-link-2[_ngcontent-sc86]:active{color:#fff}.drawer-container[_ngcontent-sc86]{top:64px;height:calc(100vh - 64px)}  .mat-drawer-inner-container::-webkit-scrollbar{height:4px;width:4px}  .mat-drawer-inner-container::-webkit-scrollbar-thumb{background:rgba(0,0,0,.26)}.sidebar[_ngcontent-sc86]{min-width:240px;max-width:240px}.sidebar[_ngcontent-sc86]   .section-title[_ngcontent-sc86]{color:#757575;font-size:20px;padding-left:16px}.sidebar[_ngcontent-sc86]   .section-content[_ngcontent-sc86]{color:#757575;text-align:center}.sidebar[_ngcontent-sc86]   .mat-divider[_ngcontent-sc86]{margin:4px 0}.sidebar[_ngcontent-sc86]   .post-statics[_ngcontent-sc86]{padding:16px;display:flex}.sidebar[_ngcontent-sc86]   .post-statics[_ngcontent-sc86]   .statics-block[_ngcontent-sc86]{flex:33%;display:flex;flex-direction:column}.sidebar[_ngcontent-sc86]   .post-statics[_ngcontent-sc86]   .statics-block[_ngcontent-sc86]   a[_ngcontent-sc86]{text-decoration:none}.sidebar[_ngcontent-sc86]   .post-statics[_ngcontent-sc86]   .statics-block[_ngcontent-sc86]   .counter[_ngcontent-sc86]{color:#3f51b5;font-size:24px;text-align:center}.sidebar[_ngcontent-sc86]   .post-statics[_ngcontent-sc86]   .statics-block[_ngcontent-sc86]   .description[_ngcontent-sc86]{color:#757575;font-size:16px;text-align:center}.sidebar[_ngcontent-sc86]   .mat-list-item[_ngcontent-sc86]{color:#757575}.sidebar[_ngcontent-sc86]   .mat-list-item[_ngcontent-sc86]   .mat-icon[_ngcontent-sc86]{padding-right:8px;display:flex;align-items:center;justify-content:center}.sidebar[_ngcontent-sc86]   .mat-list-item[_ngcontent-sc86]   .mat-icon.fab[_ngcontent-sc86]{font-size:20px}.sidebar[_ngcontent-sc86]   .mat-list-item.active[_ngcontent-sc86]{color:#3f51b5;background:rgba(63,81,181,.15)}.main-content.server[_ngcontent-sc86]{margin-left:240px}</style><style ng-transition="serverApp">.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}
</style><style ng-transition="serverApp">.mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}
</style><style ng-transition="serverApp">.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}
</style><style ng-transition="serverApp">.mat-divider{display:block;margin:0;border-top-width:1px;border-top-style:solid}.mat-divider.mat-divider-vertical{border-top:0;border-right-width:1px;border-right-style:solid}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}
</style><style ng-transition="serverApp">.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:transparent;text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-selection-list:focus{outline-style:dotted}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-list-option:focus,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:focus,.cdk-high-contrast-active mat-action-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:focus{outline:dotted 1px;z-index:1}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-single-selected-option):not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}
</style><style ng-transition="serverApp">.mat-icon{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}
</style><style ng-transition="serverApp">.blog-page-container[_ngcontent-sc87]{padding:16px}.go-top[_ngcontent-sc87]{position:fixed;bottom:32px;right:64px}</style><style ng-transition="serverApp">.mat-divider[_ngcontent-sc131]{margin:8px 0}.blog-post-container[_ngcontent-sc131]{display:flex;align-items:flex-start}.blog-post-container[_ngcontent-sc131]   .blog-post-overview[_ngcontent-sc131]{flex:80%}.blog-post-container[_ngcontent-sc131]   .blog-post-toc[_ngcontent-sc131]{flex:19%}.blog-post-container[_ngcontent-sc131]   .blog-post-prev-next[_ngcontent-sc131]{display:flex;align-items:flex-start}.blog-post-container[_ngcontent-sc131]   .blog-post-prev-next[_ngcontent-sc131]   a[_ngcontent-sc131]{width:100%}.blog-post-container[_ngcontent-sc131]   .blog-post-prev-next[_ngcontent-sc131]   .blog-post-prev[_ngcontent-sc131]{display:flex;flex-direction:column;flex:50%;align-items:flex-start;justify-content:flex-start;text-align:start}.blog-post-container[_ngcontent-sc131]   .blog-post-prev-next[_ngcontent-sc131]   .blog-post-next[_ngcontent-sc131]{display:flex;flex-direction:column;flex:50%;align-items:flex-start;justify-content:flex-end;text-align:end}.blog-post-container[_ngcontent-sc131]   .blog-post-prev-next[_ngcontent-sc131]   .blog-post-prev-next-notify[_ngcontent-sc131]{display:flex;align-items:center;font-size:12px;color:#9e9e9e;width:100%}.blog-post-container[_ngcontent-sc131]   .blog-post-prev-next[_ngcontent-sc131]   .blog-post-prev-next-notify.prev[_ngcontent-sc131]{justify-content:flex-start}.blog-post-container[_ngcontent-sc131]   .blog-post-prev-next[_ngcontent-sc131]   .blog-post-prev-next-notify.next[_ngcontent-sc131]{justify-content:flex-end}.go-comment[_ngcontent-sc131]{position:fixed;bottom:32px;right:128px}</style><meta name="keywords" content="RxJS,ajax,map,switchMap,debounceTime,distinctUntilChanged,share,shareReplay,filter,take,startWith,catchError,mapTo,scan"><meta name="description" content="今天我們用實際的例子來練習各種 RxJS operators 的組合運用！在一般的應用程式裡面，資料查詢應該算是非常常見的情境了，我們就實際使用資料查詢的功能做範例，加上各種變化，來練習一些 operators 的實際使用吧！"><meta property="og:type" content="article"><meta property="og:title" content="[RxJS] 實戰練習 - 自動完成 / 搜尋 / 排序 / 分頁 | 全端開發人員天梯"><meta property="og:site_name" content="全端開發人員天梯"><meta property="og:description" content="今天我們用實際的例子來練習各種 RxJS operators 的組合運用！在一般的應用程式裡面，資料查詢應該算是非常常見的情境了，我們就實際使用資料查詢的功能做範例，加上各種變化，來練習一些 operators 的實際使用吧！"><meta property="og:locale" content="zh-tw"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="[RxJS] 實戰練習 - 自動完成 / 搜尋 / 排序 / 分頁 | 全端開發人員天梯"><meta name="twitter:description" content="今天我們用實際的例子來練習各種 RxJS operators 的組合運用！在一般的應用程式裡面，資料查詢應該算是非常常見的情境了，我們就實際使用資料查詢的功能做範例，加上各種變化，來練習一些 operators 的實際使用吧！"><style ng-transition="serverApp">[_nghost-sc113]{display:flex;align-items:center}</style><style ng-transition="serverApp">.mat-chip{position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;transform:translateZ(0);border:none;-webkit-appearance:none;-moz-appearance:none}.mat-standard-chip{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:inline-flex;padding:7px 12px;border-radius:16px;align-items:center;cursor:default;min-height:32px;height:1px}._mat-animation-noopable.mat-standard-chip{transition:none;animation:none}.mat-standard-chip .mat-chip-remove{border:none;-webkit-appearance:none;-moz-appearance:none;padding:0;background:none}.mat-standard-chip .mat-chip-remove.mat-icon,.mat-standard-chip .mat-chip-remove .mat-icon{width:18px;height:18px;font-size:18px}.mat-standard-chip::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;opacity:0;content:"";pointer-events:none;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-standard-chip:hover::after{opacity:.12}.mat-standard-chip:focus{outline:none}.mat-standard-chip:focus::after{opacity:.16}.cdk-high-contrast-active .mat-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-standard-chip:focus{outline:dotted 2px}.mat-standard-chip.mat-chip-disabled::after{opacity:0}.mat-standard-chip.mat-chip-disabled .mat-chip-remove,.mat-standard-chip.mat-chip-disabled .mat-chip-trailing-icon{cursor:default}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar,.mat-standard-chip.mat-chip-with-avatar{padding-top:0;padding-bottom:0}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-right:8px;padding-left:0}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-left:8px;padding-right:0}.mat-standard-chip.mat-chip-with-trailing-icon{padding-top:7px;padding-bottom:7px;padding-right:8px;padding-left:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon{padding-left:8px;padding-right:12px}.mat-standard-chip.mat-chip-with-avatar{padding-left:0;padding-right:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-avatar{padding-right:0;padding-left:12px}.mat-standard-chip .mat-chip-avatar{width:24px;height:24px;margin-right:8px;margin-left:4px}[dir=rtl] .mat-standard-chip .mat-chip-avatar{margin-left:8px;margin-right:4px}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{width:18px;height:18px;cursor:pointer}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-standard-chip .mat-chip-remove,[dir=rtl] .mat-standard-chip .mat-chip-trailing-icon{margin-right:8px;margin-left:0}.mat-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit;overflow:hidden}.mat-chip-list-wrapper{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;margin:-4px}.mat-chip-list-wrapper input.mat-input-element,.mat-chip-list-wrapper .mat-standard-chip{margin:4px}.mat-chip-list-stacked .mat-chip-list-wrapper{flex-direction:column;align-items:flex-start}.mat-chip-list-stacked .mat-chip-list-wrapper .mat-standard-chip{width:100%}.mat-chip-avatar{border-radius:50%;justify-content:center;align-items:center;display:flex;overflow:hidden;object-fit:cover}input.mat-chip-input{width:150px;margin:4px;flex:1 0 150px}
</style></head>
<body>
  <app-root _nghost-sc86="" ng-version="12.2.9"><mat-toolbar _ngcontent-sc86="" color="primary" xmlns="http://www.w3.org/1999/html" class="mat-toolbar toolbar mat-elevation-z6 mat-primary mat-toolbar-single-row"><button _ngcontent-sc86="" mat-icon-button="" class="mat-focus-indicator mat-icon-button mat-button-base _mat-animation-noopable"><span class="mat-button-wrapper"><mat-icon _ngcontent-sc86="" role="img" class="mat-icon notranslate material-icons mat-icon-no-color ng-star-inserted" aria-hidden="true" data-mat-icon-type="font">menu_open</mat-icon><!----><!----></span><span matripple="" class="mat-ripple mat-button-ripple mat-button-ripple-round"></span><span class="mat-button-focus-overlay"></span></button><h1 _ngcontent-sc86=""><a _ngcontent-sc86="" routerlink="/" class="header-link" href="/"><span _ngcontent-sc86="" class="header-link-1">全端開發</span><span _ngcontent-sc86="" class="header-link-2">人員天梯</span></a></h1></mat-toolbar><mat-drawer-container _ngcontent-sc86="" class="mat-drawer-container drawer-container"><div class="mat-drawer-backdrop ng-star-inserted"></div><!----><div class="cdk-visually-hidden cdk-focus-trap-anchor" aria-hidden="true"></div><mat-drawer _ngcontent-sc86="" tabindex="-1" mode="side" disableclose="" class="mat-drawer sidebar ng-tns-c74-0 ng-trigger ng-trigger-transform mat-drawer-side mat-drawer-opened ng-star-inserted" style="transform:none;visibility:visible;"><div cdkscrollable="" class="mat-drawer-inner-container ng-tns-c74-0"><div _ngcontent-sc86="" class="post-statics ng-tns-c74-0"><div _ngcontent-sc86="" class="statics-block"><a _ngcontent-sc86="" routerlink="/blog/archives" href="/blog/archives"><div _ngcontent-sc86="" class="counter">214</div><div _ngcontent-sc86="" class="description">文章</div></a></div><div _ngcontent-sc86="" class="statics-block"><a _ngcontent-sc86="" routerlink="/blog/categories" href="/blog/categories"><div _ngcontent-sc86="" class="counter">14</div><div _ngcontent-sc86="" class="description">分類</div></a></div><div _ngcontent-sc86="" class="statics-block"><a _ngcontent-sc86="" routerlink="/blog/tags" href="/blog/tags"><div _ngcontent-sc86="" class="counter">313</div><div _ngcontent-sc86="" class="description">標籤</div></a></div></div><mat-divider _ngcontent-sc86="" role="separator" class="mat-divider ng-tns-c74-0 mat-divider-horizontal" aria-orientation="horizontal"></mat-divider><div _ngcontent-sc86="" class="ng-tns-c74-0"><div _ngcontent-sc86="" class="section-title">好書推薦</div><div _ngcontent-sc86="" class="section-content"><mat-nav-list _ngcontent-sc86="" role="navigation" class="mat-nav-list mat-list-base"><a _ngcontent-sc86="" href="https://www.tenlong.com.tw/products/9789864348039" target="_blank" style="display: flex; flex-direction: column; align-items: center;"><img _ngcontent-sc86="" src="assets/promotion/rxjs.webp" width="160px" alt="打通 RxJS 任督二脈 - 好評熱售中！"><div _ngcontent-sc86="">打通 RxJS 任督二脈</div></a></mat-nav-list></div></div><mat-divider _ngcontent-sc86="" role="separator" class="mat-divider ng-tns-c74-0 mat-divider-horizontal" aria-orientation="horizontal"></mat-divider><mat-nav-list _ngcontent-sc86="" role="navigation" class="mat-nav-list mat-list-base ng-tns-c74-0"><a _ngcontent-sc86="" mat-list-item="" routerlinkactive="active" class="mat-list-item mat-focus-indicator ng-star-inserted" href="/blog" style=""><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"></div><mat-icon _ngcontent-sc86="" role="img" class="mat-icon notranslate material-icons mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font">home</mat-icon><span _ngcontent-sc86="" class="link-text">首頁</span></div></a><a _ngcontent-sc86="" mat-list-item="" routerlinkactive="active" class="mat-list-item mat-focus-indicator ng-star-inserted" href="/blog/categories" style=""><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"></div><mat-icon _ngcontent-sc86="" role="img" class="mat-icon notranslate material-icons mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font">apps</mat-icon><span _ngcontent-sc86="" class="link-text">分類</span></div></a><a _ngcontent-sc86="" mat-list-item="" routerlinkactive="active" class="mat-list-item mat-focus-indicator ng-star-inserted" href="/blog/tags" style=""><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"></div><mat-icon _ngcontent-sc86="" role="img" class="mat-icon notranslate material-icons mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font">label</mat-icon><span _ngcontent-sc86="" class="link-text">標籤</span></div></a><a _ngcontent-sc86="" mat-list-item="" routerlinkactive="active" class="mat-list-item mat-focus-indicator ng-star-inserted" href="/blog/archives" style=""><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"></div><mat-icon _ngcontent-sc86="" role="img" class="mat-icon notranslate material-icons mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font">archive</mat-icon><span _ngcontent-sc86="" class="link-text">歸檔</span></div></a><!----></mat-nav-list><mat-divider _ngcontent-sc86="" role="separator" class="mat-divider ng-tns-c74-0 mat-divider-horizontal" aria-orientation="horizontal"></mat-divider><mat-nav-list _ngcontent-sc86="" role="navigation" class="mat-nav-list mat-list-base ng-tns-c74-0"><a _ngcontent-sc86="" mat-list-item="" href="/blog/atom.xml" target="_blank" class="mat-list-item mat-focus-indicator"><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"></div><mat-icon _ngcontent-sc86="" role="img" class="mat-icon notranslate material-icons mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font">rss_feed</mat-icon><span _ngcontent-sc86="" class="link-text">RSS</span></div></a><a _ngcontent-sc86="" mat-list-item="" href="https://github.com/wellwind/" target="_blank" class="mat-list-item mat-focus-indicator"><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"></div><mat-icon _ngcontent-sc86="" role="img" fontset="fontawesome" fonticon="fa-github" class="mat-icon notranslate fa-github fab mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font" data-mat-icon-name="fa-github" data-mat-icon-namespace="fontawesome"></mat-icon><span _ngcontent-sc86="" class="link-text">GitHub</span></div></a><a _ngcontent-sc86="" mat-list-item="" href="https://www.facebook.com/fullstackledder" target="_blank" class="mat-list-item mat-focus-indicator"><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"></div><mat-icon _ngcontent-sc86="" role="img" fontset="fontawesome" fonticon="fa-facebook" class="mat-icon notranslate fa-facebook fab mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font" data-mat-icon-name="fa-facebook" data-mat-icon-namespace="fontawesome"></mat-icon><span _ngcontent-sc86="" class="link-text">Facebook</span></div></a></mat-nav-list><div _ngcontent-sc86="" data-href="https://www.facebook.com/fullstackledder" data-tabs="timeline" data-width="235" data-height="450" data-small-header="true" data-adapt-container-width="true" data-hide-cover="true" data-show-facepile="true" class="fb-page ng-tns-c74-0"><blockquote _ngcontent-sc86="" cite="https://www.facebook.com/fullstackledder" class="fb-xfbml-parse-ignore"><a _ngcontent-sc86="" href="https://www.facebook.com/fullstackledder">全端開發人員天梯</a></blockquote></div></div></mat-drawer><div class="cdk-visually-hidden cdk-focus-trap-anchor" aria-hidden="true"></div><mat-drawer-content _ngcontent-sc86="" class="mat-drawer-content main-content server" style="margin-left:;margin-right:;"><router-outlet _ngcontent-sc86=""></router-outlet><app-blog-layout _nghost-sc87="" class="ng-star-inserted"><div _ngcontent-sc87="" class="blog-page-container"><router-outlet _ngcontent-sc87=""></router-outlet><app-blog-post _nghost-sc131="" class="ng-star-inserted"><div _ngcontent-sc131="" class="blog-post-container ng-star-inserted"><div _ngcontent-sc131="" class="blog-post"><div _ngcontent-sc131="" class="blog-post-title"><h1 _ngcontent-sc131="">[RxJS] 實戰練習 - 自動完成 / 搜尋 / 排序 / 分頁</h1></div><div _ngcontent-sc131="" class="blog-post-subtitle"><app-blog-post-subtitle _ngcontent-sc131="" _nghost-sc113=""><span _ngcontent-sc113="" class="blog-post-published ng-star-inserted"><mat-icon _ngcontent-sc113="" role="img" class="mat-icon notranslate material-icons mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font">date_range</mat-icon><span _ngcontent-sc113="">2020-10-17</span></span><span _ngcontent-sc113="" class="blog-post-categories ng-star-inserted"><mat-icon _ngcontent-sc113="" role="img" class="mat-icon notranslate material-icons mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font">folder_open</mat-icon><a _ngcontent-sc113="" class="blog-post-category-link ng-star-inserted" href="/blog/categories/%E6%89%93%E9%80%9A-RxJS-%E4%BB%BB%E7%9D%A3%E4%BA%8C%E8%84%88">打通 RxJS 任督二脈</a><span _ngcontent-sc113="" class="sub-divider ng-star-inserted">|</span><!----><!----><a _ngcontent-sc113="" class="blog-post-category-link ng-star-inserted" href="/blog/categories/%E7%AC%AC-12-%E5%B1%86%E9%90%B5%E4%BA%BA%E8%B3%BD">第 12 屆鐵人賽</a><!----><!----><!----></span><!----><!----><!----><!----></app-blog-post-subtitle></div><mat-divider _ngcontent-sc131="" role="separator" class="mat-divider mat-divider-horizontal" aria-orientation="horizontal"></mat-divider><div _ngcontent-sc131="" class="blog-post"><p>今天我們用實際的例子來練習各種 RxJS operators 的組合運用！在一般的應用程式裡面，資料查詢應該算是非常常見的情境了，我們就實際使用資料查詢的功能做範例，加上各種變化，來練習一些 operators 的實際使用吧！</p>
<h1 id="起始專案">起始專案</h1>
<p>由於我們主要的練習目標是 RxJS，因此許多關於畫面操作的部分，都已經先設計好了，可以到以下網址以起始專案開始練習：</p>
<p><a href="https://stackblitz.com/edit/mastering-rxjs-practice-search-starter">https://stackblitz.com/edit/mastering-rxjs-practice-search-starter</a></p>
<p></p><div class="note info"><p>如果想要跟著練習，建議可以 fork 一份到自己的帳號下，以後可以隨時回來看成果。</p></div><p>
</p><p>練習過程中，也可以參考完整版程式碼：</p>
<p><a href="https://stackblitz.com/edit/mastering-rxjs-practice-search-finished">https://stackblitz.com/edit/mastering-rxjs-practice-search-finished</a></p>
<h2 id="預期功能及畫面">預期功能及畫面</h2>
<p>在這個專案中，我們要練習使用 <a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/search#search-repositories">GitHub Search API</a> 來依照指定的名稱搜尋 repositories，預期完成畫面如下：</p>
<p><img src="./assets/blog/mastering-rxjs-31-practicing-autocomplete-search-sort-pagination/01.jpg" alt="" title=""></p>
<p>包含一些基本功能：</p>
<ul>
<li>依照關鍵字搜尋 GitHub repositories</li>
<li>分頁功能，包含每頁幾筆及顯示第幾頁</li>
<li>排序功能，可依照 stars 或 forks 進行排序</li>
</ul>
<p>另外還包含了搜尋時的「自動完成」功能：</p>
<p><img src="./assets/blog/mastering-rxjs-31-practicing-autocomplete-search-sort-pagination/02.jpg" alt="" title=""></p>
<p>當輸入文字時，可以提供符合文字的 repositories 建議。</p>
<h2 id="相關檔案">相關檔案</h2>
<p>在起始專案的 <code>index.html</code> 內已經把基本的 HTML 都寫好了，另外在 <code>index.ts</code> 內也預先 import 已經寫好的操作邏輯</p>
<pre><code class="language-typescript">// 畫面上的 DOM 物件操作程式
import * as domUtils from './dom-utils';
// 存取 API 資料的程式碼
import * as dataUtils from './data-utils';
</code></pre>
<p><code>dom-utils.ts</code> 內都是操作畫面的邏輯，但這不是主要練習的部分，現在前端 SPA 框架的盛行，不同框架會有不同的畫面操作方式，單純操作 DOM 物件其實是髒活，所以大概知道有些什麼功能就好囉：</p>
<ul>
<li><code>fillAutoSuggestions</code>：顯示自動完成的建議內容</li>
<li><code>fillSearchResult</code>：顯示搜尋結果</li>
<li><code>loading</code>：當開始搜尋資料時，呼叫此方法將畫面遮罩，避免多餘的操作</li>
<li><code>loaded</code>：當完成搜尋後，呼叫次方法隱藏畫面遮罩，以便進行其他操作</li>
<li><code>updatePageNumber</code>：更新頁碼的畫面資訊</li>
<li><code>updateStarsSort</code>：更新依照 stars 排序的畫面資訊</li>
<li><code>updateForksSort</code>：更新依照 forks 排序的畫面資訊</li>
</ul>
<p>而在 <code>data-utils.ts</code> 內，則是 GitHub API 的呼叫，這裡使用 RxJS 內提供的 <code>ajax</code> 來抓取呼叫 API 的內容，並使用 <code>map</code> operator 來將需要的內容抓出來，例如「取得建議清單」的程式碼如下：</p>
<pre><code class="language-typescript">const baseUrl = `https://api.github.com/search/repositories`

export const getSuggestions = (keyword: string) =&gt; {
  const searchUrl = `${baseUrl}?q=${keyword}&amp;per_page=10&amp;page=1`;
  return ajax(searchUrl).pipe(
    map(response =&gt; response.response.items),
    map(repositories =&gt;
      repositories.map(repository =&gt; repository.full_name))
  );
};
</code></pre>
<p>上述程式碼的第 7 行使用的是 RxJS 內的 <code>map</code> operator，而第 8 行使用的是 JavaScript 內建陣列的 <code>map</code>，有些時候在閱讀上會不小心造成誤解，這時候可以把裡面的實作邏輯也抽出來，會變得更好閱讀：</p>
<pre><code class="language-typescript">// 將陣列的處理抽成 function
const toSuggestionList = (repositories) =&gt; {
  return repositories.map(repository =&gt; repository.full_name)
};

export const getSuggestions = (keyword: string) =&gt; {
  const searchUrl = `${baseUrl}?q=${keyword}&amp;per_page=10&amp;page=1`;
  return ajax(searchUrl).pipe(
    map(response =&gt; response.response.items),
    map(toSuggestionList)
  );
};
</code></pre>
<p>此時原來程式就可以閱讀成「將回傳結果轉換成建議清單 (map to suggestion list)」，在實作程式碼比較複雜，或是閱讀上比較不好理解時，適當的將程式碼抽成好讀好理解的 function 對於未來開發和維護都會有加分效果喔！</p>
<p><code>data-utils.ts</code> 內還有一個 <code>getSearchResult</code> 方法，是用來取得搜尋結果的，實作基本上大同小異，只是帶入更多的參數而已，就不浪費篇幅在這說明了，有興趣的話可以看一下囉。</p>
<h1 id="實作自動完成功能">實作自動完成功能</h1>
<p>接著我們來實際做出自動完成的功能，自動完成要做的事情非常簡單，就是在打字時，呼叫 <code>dataUtils.getSuggestions()</code> 方法來取得要顯示的清單，並且呼叫 <code>domUtils.fillAutoSuggestions()</code> 即可。</p>
<h2 id="取得事件資訊">取得事件資訊</h2>
<p>我們可以使用 <code>fromEvent</code> 來監聽輸入框的 <code>input</code> 事件：</p>
<pre><code class="language-typescript">const keyword$ = fromEvent(document.querySelector('#keyword'), 'input');
</code></pre>
<p>此時訂閱的話回得到 <code>input</code> 相關的事件，然而我們實際上需要關注的是輸入的內容，因此可以使用 <code>map</code> 來進行轉換：</p>
<pre><code class="language-typescript">const keyword$ = fromEvent(document.querySelector('#keyword'), 'input').pipe(
  map(event =&gt; (event.target as HTMLInputElement).value)
);
</code></pre>
<p>這邊使用了 <code>event.target</code> 來取得事件來源的 DOM 物件，由於是一個 <code>input</code> 輸入框，因此可以使用 <code>.value</code> 來取得相關的值，<code>as HTMLInputElement</code> 是 TypeScript 的型別轉換，讓我們可以明確的知道 <code>input</code> 輸入框有哪些屬性可用。</p>
<p>此時 <code>keyword$</code> 就是一個「關鍵字內容的資料流」，我們可以再將此資料流搭配各種其他的 operators 來產生出不同的變化。</p>
<h2 id="將事件轉換成查詢-observable">將事件轉換成查詢 Observable</h2>
<p>現在已經可以拿到輸入的關鍵字了，接下來要把關鍵字帶入 <code>domUtils.getSuggestions()</code> 方法來查詢，最簡單的方法如下：</p>
<pre><code class="language-typescript">keyword$.subscribe(keyword =&gt; {
  domUtils.getSuggestions(keyword).subscribe(suggestions =&gt; {
    domUtils.fillAutoSuggestions(suggestions);
  });
});
</code></pre>
<p>不用多說，這種巢狀的 <code>subscribe</code> 是應該盡力避免的，因此我們改用 <code>switchMap</code> operator 來協助我們「將某個事件值換成另一個 Observable」：</p>
<pre><code class="language-typescript">keyword$
  .pipe(
    switchMap(keyword =&gt; dataUtils.getSuggestions(keyword))
  )
  .subscribe(suggestions =&gt; {
    domUtils.fillAutoSuggestions(suggestions);
  });
</code></pre>
<p>使用 <code>switchMap</code> 可以在來源資料變更時，退訂上一次的 Observable 訂閱，因此永遠會以最新的來源資料及轉換後的 Observable 為主，如此可以確保我們拿到的資料一定是使用最新的 <code>keyword</code> 關鍵字查詢的結果。</p>
<p></p><div class="note info"><p>這邊說明一下為何不使用其他 <code>xxxMap</code> 系列的 operators：</p>
<ul>
<li><code>concatMap</code>：雖然會拿到最後的資料，但因為不會退訂上一次 Observable 訂閱的關係，需要等之前 keyword 變更的查詢都結束，會花費比較多時間。</li>
<li><code>mergeMap</code>：每次 keyword 變更都會立刻查詢，不退訂之前的 Observable，加上 API 呼叫是非同步的關係，我們沒辦法確保最後一次會來的結果一定就是最新的查詢結果，因此查詢結果會不穩定。</li>
<li><code>exhaustMap</code>：在之前 Observable 查詢完成之前，有任何新的事件都會被忽略掉，因此只要事件更新前轉換的 Observable 沒結束，就不會拿到新事件的查詢結果。</li>
</ul>
<p>如果不明白這幾個 operators 的差別，請先看過之前寫的文章：</p>
<p><a href="https://wellwind.idv.tw/blog/2020/10/04/mastering-rxjs-19-switchmap-concatmap-mergemap-exhaustmap/">[RxJS] 轉換類型 Operators (2) - switchMap / concatMap / mergeMap / exhaustMap</a></p></div><p>
</p><p>此時已經可以在每次輸入關鍵字就進行查詢囉，但還有很多需要加強的地方！</p>
<h2 id="避免資料一變更就查詢">避免資料一變更就查詢</h2>
<p>GitHub API 在未驗證時有限制每分鐘只能進行 10 次查詢(有驗證時限制每分鐘 30 次查詢)，這是為了保護伺服器被大量搜尋的機制(稱為 Rate Limits)，在實際應用上，我們也應該要盡可能避免使用者產生大量的查詢，以免前端的疏失操成後端的效能低落，因此在這裡我們可以再加上一個 <code>debounceTime</code> operator，來避免一有新事件就查詢的問題：</p>
<pre><code class="language-typescript">keyword$
  .pipe(
    // 避免一有新事件就查詢
    debounceTime(700),
    switchMap(keyword =&gt; dataUtils.getSuggestions(keyword)),
  )
  .subscribe(suggestions =&gt; {
    domUtils.fillAutoSuggestions(suggestions);
  });
</code></pre>
<p><code>debounceTime</code> 可以在指定的時間內都沒有新事件發生後，才以最後一次的事件值進入下一個步驟，透過這種方式，就可以避免一直打字一直查詢的問題囉。</p>
<h2 id="避免重複文字查詢">避免重複文字查詢</h2>
<p>想像一下，假設目前輸入的內容是「rxjs」，並且已經完成一次建議清單的查詢，接著我們繼續輸入變成「rxjsdemo」，但想了一下又刪掉變回「rxjs」，然後 <code>debounceTime</code> 的控制時間才過去，新的事件資料跟上一次的事件資料一樣都是「rxjs」，如果資料其實並沒有改變，還需要再進行一次查詢嗎？這時候當然就可以省略不查詢了，因此可以使用 <code>distinctUntilChanged</code> operator，只有當新的事件值與上一次的事件值不同時，才會繼續讓事件發生：</p>
<pre><code class="language-typescript">keyword$
  .pipe(
    debounceTime(700),
    // 避免重複的查詢
    disintctUntilChanged(),
    switchMap(keyword =&gt; dataUtils.getSuggestions(keyword)),
  )
  .subscribe(suggestions =&gt; {
    domUtils.fillAutoSuggestions(suggestions);
  });
</code></pre>
<p></p><div class="note info"><p>如果要避免資料重複，為何不使用 <code>distinct</code> 呢？以這邊的例子來說，當我把資料變更成「rxjsdemo」時，如果有產生新的查詢，下一次變更回「rxjs」時，由於 <code>distinct</code> 的設計是「整個資料流的事件值不會重複」，因此「rxjs」事件值在整個資料流過程已經發生過了會被忽略掉，導致沒有正確查詢，畫面顯示錯誤的資料。</p>
<p>而使用 <code>distinctUntilChanged</code>，則只有跟「上一次」事件值相同才會忽略，因此可以避免掉 <code>distinct</code> 的問題。</p>
<p><code>distinct</code> 和 <code>distinctUntilChanged</code> 的差別，可以參考之前寫的文章：</p>
<p><a href="https://wellwind.idv.tw/blog/2020/10/09/mastering-rxjs-24-distinct-distinctuntilchanged-distinctuntilkeychanged/">[RxJS] 過濾類型 Operators (4) - distinct / distinctUntilChanged / distinctUntilKeyChanged</a></p></div><p>
</p><h2 id="避免查出不精準的內容">避免查出不精準的內容</h2>
<p>最後來微調一下，如果不管資料長度都會進行搜尋，就會導致一開始只輸入一個「r」這樣的資料時就會開始進行搜尋，而得到比較不精準的內容，因此可以再做個調整，讓查詢內容大於某個長度時才進行搜尋，例如至少要 3 個字，此時使用最基本的 <code>filter</code> operator 就可以了：</p>
<pre><code class="language-typescript">keyword$
  .pipe(
    debounceTime(700),
    disintctUntilChanged(),
    // 避免內容太少查出不精準的結果
    filter(keyword =&gt; keyword.length &gt;= 3),
    switchMap(keyword =&gt; dataUtils.getSuggestions(keyword)),
  )
  .subscribe(suggestions =&gt; {
    domUtils.fillAutoSuggestions(suggestions);
  });
</code></pre>
<p>透過這些 operators 的控制，就能設計出兼顧效能及準度的自動建議功能啦。</p>
<p>像這樣的程式碼，可以想想看沒有各種 operators 加持的情況下，要判斷多少狀態、條件，而有了 RxJS 及各種 operators，真的可以幫助我們大幅減少許多程式碼的撰寫！</p>
<h1 id="實作關鍵字搜尋功能">實作關鍵字搜尋功能</h1>
<p>關鍵字的建議及自動完成功能搞定了，接著先來單純的針對關鍵字進行搜尋，這裡我們希望按下「search」按鈕時，才針對我們要的關鍵字進行查詢：</p>
<h2 id="取得事件資訊">取得事件資訊</h2>
<p>一樣的，我們可以使用 <code>fromEvent</code> 來將按鈕事件包裝成 Observable</p>
<pre><code class="language-typescript">const search$ = fromEvent(document.querySelector('#search'), 'click');
</code></pre>
<p>接著我們就需要在事件發生時，依照輸入的關鍵字進行搜尋。</p>
<h2 id="將事件轉換成查詢-observable">將事件轉換成查詢 Observable</h2>
<p>我們一樣可以透過 <code>switchMap</code> operators 來將按鈕事件轉換成查詢資料的 Observable：</p>
<pre><code class="language-typescript">search$.pipe(
  switchMap(() =&gt; dataUtils.getSearchResult(
    (document.querySelector('#keyword') as HTMLInputElement).value)
  )
).subscribe(result =&gt; {
  domUtils.fillSearchResult(result);
});
</code></pre>
<p>第 2 行程式使用 <code>switchMap</code> 將事件轉換成查詢的 Observable，裡面的參數在第 3 行直接取得輸入框 DOM 物件資料。</p>
<p>在關鍵字內容部分，我們已經有一個 <code>keyword$</code> 的資料流了，不多加運用實在很可惜：</p>
<pre><code class="language-typescript">const searchByKeyword$ = search$.pipe(
  switchMap(() =&gt; keyword$),
  switchMap(keyword =&gt; dataUtils.getSearchResult(keyword))
);

searchByKeyword$.pipe(
  switchMap(keyword =&gt; dataUtils.getSearchResult(keyword))
).subscribe(result =&gt; {
  domUtils.fillSearchResult(result);
});
</code></pre>
<p>我們建立了一個 <code>searchByKeyword$</code> 的 Observable，它會：</p>
<ol>
<li>當搜尋按鈕按下時，轉換成 <code>keyword$</code> Observable</li>
<li>當 <code>keyword$</code> Observable 有新事件時，轉換查詢用的 Observable</li>
</ol>
<p>但這樣會有兩個問題：</p>
<ol>
<li>轉換為 <code>keyword$</code> 後，還沒有新的事件發生，因此不會進行查詢，需要等 <code>keyword$</code> 有新事件才會查詢</li>
<li>因為 <code>keyword$</code> 資料流不會結束(因為隨時可能輸入新的文字)，因此搜尋按鈕事件後，每次 <code>keyword$</code> 有新事件都會變成查詢，這不是我們要的，我們希望拿到最新的關鍵字後直接進行查詢，然後結束。</li>
</ol>
<p>接著我們來解決這兩個問題</p>
<h3 id="共享關鍵字資料流">共享關鍵字資料流</h3>
<p>由於轉換成 <code>keyword$</code> 後，需要等待新事件才會查詢，我們希望能立刻得到最後一次事件資料，因此我們可以使用 <code>shareReplay()</code> 將 <code>keyword$</code> 轉換成 Hot Observable 並將最後 N 次事件資料共享出來：</p>
<pre><code class="language-typescript">const keyword$ = fromEvent(document.querySelector('#keyword'), 'input').pipe(
  map(event =&gt; (event.target as HTMLInputElement).value),
  // 共享最後一次事件資料
  shareReplay(1)
);
</code></pre>
<p>在這裡我們建立了 <code>keywordForSearch$</code> 的 Observable，專門給 <code>search$</code> 轉換使用，<code>keywordForSearch$</code> 內使用 <code>shareReplay(1)</code> 確保每次訂閱時會先拿到事件的最後一筆資料。</p>
<p></p><div class="note info"><p>為何不使用 <code>share()</code> 呢？由於 <code>share()</code> 實際上是建立一個 <code>Subject</code>，而 <code>Subject</code> 的特性是訂閱後需要等 <code>Subject</code> 有新事件才會得到資料，因此使用 <code>shareReplay()</code> 來建立 <code>ReplaySubject</code> ，<code>ReplaySubject</code> 會依照設定紀錄最近 N 次事件資料。</p>
<p>關於 <code>share()</code> 和 <code>shareReplay()</code> 背後默默做的事情及差異，可以參考之前的文章：</p>
<p><a href="https://wellwind.idv.tw/blog/2020/10/15/mastering-rxjs-30-multicast-publish-refcount-share-sharereplay/">[RxJS] Multicast 類 Operator (1) - multicast / publish / refCount / share / shareReplay</a></p></div><p>
</p><h3 id="確保-switchmap-內資料流會結束">確保 switchMap 內資料流會結束</h3>
<p>確定可以拿到 <code>keyword$</code> 最後一次事件資料後，接著來處理事件不會結束的問題，這個問題很好解決，使用 <code>take</code> 就好，<code>take</code> operator 可以在訂閱後取得前 N 次事件資料，然後結束資料流，因此只需要設定成 1，就可以在拿到第一次資料後結束。</p>
<pre><code class="language-typescript">const keywordForSearch$ = keyword$.pipe(
  // 取得一次資料流事件後結束
  take(1)
);
const searchByKeyword$ = search$.pipe(switchMap(() =&gt; keywordForSearch$));
</code></pre>
<p>整體流程就會變成：</p>
<ol>
<li><code>search$</code> 發生新事件，轉換成 <code>keywordForSearch$</code> Observable</li>
<li><code>keywordForSearch$</code> Observable 使用 <code>keyword$</code> 作為來源，並且有 <code>shareReplay(1)</code> 的關係，會立刻得到最近一次 <code>keyword$</code> 的事件資料</li>
<li>再加上 <code>take(1)</code>，因此在取得最近一次事件資料的同時，結束 Observable</li>
</ol>
<h3 id="排除按鈕事件比關鍵字事件早發生的問題">排除按鈕事件比關鍵字事件早發生的問題</h3>
<p>最後，還有一個問題：當搜尋按鈕按下時，如果 <code>keyword$</code> 還沒有事件資料，那麼轉換後的 <code>keywordForSearch$</code> 就不會立刻結束，此時會變成按下按鈕後，再變更搜尋文字才會進行查詢，這是不合理的，因此我們要給 <code>keyword$</code> 資料流一個初始資料：</p>
<pre><code class="language-typescript">const keyword$ = fromEvent(document.querySelector('#keyword'), 'input').pipe(
  map(event =&gt; (event.target as HTMLInputElement).value),
  // 讓資料流有初始值
  startWith(''),
  // 共享最後一次事件資料
  shareReplay(1)
);
</code></pre>
<p>接著我們必須避免空字串的查詢，因此加上 <code>filter</code> 不讓空字串的事件發生：</p>
<pre><code class="language-typescript">const searchByKeyword$ = search$.pipe(
  switchMap(() =&gt; keywordForSearch$),
  // 排除空字串查詢
  filter(keyword =&gt; !!keyword)
);
searchByKeyword$.pipe(
  switchMap(keyword =&gt; dataUtils.getSearchResult(keyword))
).subscribe(...);
</code></pre>
<p>如此一來，就將「關鍵字變更的資料流 (<code>keyword$</code>) 」和「按鈕事件的資料流 (<code>search$</code>)」整合成「依照關鍵字進行搜尋(<code>searchByKeyword$</code>)」的資料流囉。</p>
<h1 id="實作排序與分頁功能">實作排序與分頁功能</h1>
<p>最後我們將分頁與排序都整合進搜尋功能，整個畫面就會很完整啦！</p>
<h2 id="建立搜尋條件的-observables">建立搜尋條件的 Observables</h2>
<p>之前已經有 <code>searchByKeyword$</code> 依照關鍵字查詢的 Observable 了，接著我們要處理排序、分頁等條件的 Observables。</p>
<h3 id="取得排序相關事件">取得排序相關事件</h3>
<p>在排序部分，我們希望預設能以 stars 數量降冪排序，也就是預設 stars 越多的越前面，同時能針對 stars 和 forks 進行升冪/降冪排序，stars 和 forks 是兩個不同的欄位，但排序是「一個資訊」，因此我們可以使用 <code>Subject</code> 類別，並分別訂閱兩個欄位的事件，來改變 <code>Subject</code> 資訊。</p>
<p>我們需要有一個預設的排序條件，同時在改變排序時也會需要這個排序資訊來決定下一次的排序方式，因此可以使用 <code>BehaviorSubject</code>。</p>
<pre><code class="language-typescript">// 建立 BehaviorSubject，預設使用 stars 進行降冪排序
const sortBy$ = new BehaviorSubject({ sort: 'stars', order: 'desc' });
</code></pre>
<p>接著訂閱畫面上 stars 和 forks 的點擊事件，來改變這個 <code>sortBy$</code> 的事件值：</p>
<pre><code class="language-typescript">const sortBy$ = new BehaviorSubject({ sort: 'stars', order: 'desc' });
const changeSort = (sortField: string) =&gt; {
  if (sortField === sortBy$.value.sort) {
    sortBy$.next({
      sort: sortField,
      order: sortBy$.value.order === 'asc' ? 'desc' : 'asc'
    });
  } else {
    sortBy$.next({
      sort: sortField,
      order: 'desc'
    });
  }
};

fromEvent(document.querySelector('#sort-stars'), 'click').subscribe(() =&gt; {
  changeSort('stars');
});
fromEvent(document.querySelector('#sort-forks'), 'click').subscribe(() =&gt; {
  changeSort('forks');
});
</code></pre>
<p>在 <code>changeSort</code> 方法裡面，我們可以使用 <code>sortBy$.value</code> 得到 <code>BehaviorSubject</code> 最近的事件值，並依此判斷接下來排序的規則。</p>
<h3 id="取得每頁幾筆的事件">取得每頁幾筆的事件</h3>
<p>接著我們先來處理「每頁顯示幾筆」的下拉選單，我們可以很容易的使用 <code>fromEvent</code> 來將 <code>select</code> 的事件資料進行轉換，這部分跟 <code>keyword$</code> 非常類似，差別只在處理的來源和事件不同而已：</p>
<pre><code class="language-typescript">const perPage$ = fromEvent(document.querySelector('#per-page'), 'change').pipe(
  map(event =&gt; +(event.target as HTMLSelectElement).value)
);
</code></pre>
<h3 id="取得切換頁碼事件">取得切換頁碼事件</h3>
<p>最後是切換頁碼，實際上是兩個按鈕分別代表「上一頁」和「下一頁」，頁數分別會「減 1」和「加 1」，因此我們可以分別把按鈕事件變成 1 和 -1，以便用來計算下一頁的頁碼：</p>
<pre><code class="language-typescript">const previousPage$ = fromEvent(
  document.querySelector('#previous-page'),
  'click'
).pipe(
  mapTo(-1)
);

const nextPage$ = fromEvent(
  document.querySelector('#next-page'), 
  'click'
).pipe(
  mapTo(1)
);
</code></pre>
<p>因為轉換的是一個固定不動的常數，因此可以直接使用 <code>mapTo</code> operator 進行轉換。</p>
<p>接著我們可以把這兩個 Observables 使用 <code>merge</code> 組合成一個 Observable，並使用 <code>scan</code> 來變更頁碼資訊：</p>
<pre><code class="language-typescript">const page$ = merge(previousPage$, nextPage$).pipe(
  scan((currentPageIndex, value) =&gt; {
    const nextPage = currentPageIndex + value;
    return nextPage &lt; 1 ? 1 : nextPage;
  }, 1)
);
</code></pre>
<p>透過這種方式，也可以輕鬆完成「下 5 頁」、「下 10 頁」的功能囉。</p>
<h2 id="將搜尋條件的-observable-組合">將搜尋條件的 Observable 組合</h2>
<p>所有查詢相關的資料來源都準備完畢後，最後我們只需要把這些條件組合在一起就可以了，我們需要每個事件最後一次的資訊，因此可以使用 <code>combinteLatest</code> 來組合每個資料流最後的事件值，再將這些資料丟給 <code>dataUtils.getSearchResult()</code> 查詢：</p>
<pre><code class="language-typescript">// 組合搜尋條件
const startSearch$ = combineLatest([
  searchByKeyword$,
  sortBy$,
  page$,
  perPage$
]);

// 將搜尋條件轉換成查詢 Observable
const searchResult$ = startSearch$.pipe(
  switchMap(([keyword, sort, page, perPage]) =&gt;
    dataUtils.getSearchResult(keyword, sort.sort, sort.order, page, perPage)
  )
);

searchResult$.subscribe(result =&gt; {
  domUtils.fillSearchResult(result);
});
</code></pre>
<p>由於 <code>combineLatest</code> 是將裡面 Observables 的「最後一次事件」組合起來，因此若某個 Observable 還沒發生過事件，整個 <code>combineLatest</code> 組合的 Observable 都還不會有事件值，此時 <code>page$</code> 和 <code>perPage$</code> 都沒有啟始資料，因此就算按下搜尋，還不會有任何反應，所以最後針對 <code>page$</code> 和 <code>perPage$</code> 再使用 <code>startWith</code> 給予初始資料：</p>
<pre><code class="language-typescript">const startSearch$ = combineLatest([
  searchByKeyword$,
  sortBy$,
  // 給予 page$ 初始資料
  page$.pipe(startWith(1)),
  // 給予 perPage$ 初始資料
  perPage$.pipe(startWith(10))
]);
</code></pre>
<p>基本的查詢、分頁和排序功能就完成啦！！</p>
<p>最後讓我們再來針對一些細節來做調整。</p>
<h1 id="顯示頁碼/排序資訊">顯示頁碼/排序資訊</h1>
<p>這部分很簡單，訂閱原來的事件，然後把事件資訊更新到畫面上就好了：</p>
<pre><code class="language-typescript">page$.subscribe(page =&gt; {
  domUtils.updatePageNumber(page);
});

sortBy$.pipe(filter(sort =&gt; sort.sort === 'stars')).subscribe(sort =&gt; {
  domUtils.updateStarsSort(sort);
});

sortBy$.pipe(filter(sort =&gt; sort.sort === 'forks')).subscribe(sort =&gt; {
  domUtils.updateForksSort(sort);
});
</code></pre>
<p>以上程式直接訂閱 <code>page$</code>，並使用 <code>domUtils.updatePageNumber()</code> 更新頁碼資訊，而排序資訊則依照排序類型有兩個不同的方法呼叫，因此使用 <code>filter</code> 將不同的的排序欄位分成兩個 Observable，並各自訂閱然後呼叫各自對應的方法來更新排序欄位資訊。</p>
<h1 id="查詢中的遮罩畫面">查詢中的遮罩畫面</h1>
<p>接下來我們需要在查詢資料時呼叫 <code>domUtils.loading()</code> 遮罩畫面，並在查詢結束時呼叫 <code>domUtils.loaded()</code> 隱藏遮罩，在查詢條件變更時就需要遮罩住畫面，因此訂閱 <code>startSearch$</code> Observable 即可：</p>
<pre><code class="language-typescript">startSearch$.subscribe(() =&gt; {
  domUtils.loading();
});
</code></pre>
<p>接著在查詢完畢後，除了畫面更新外，也要將此遮罩隱藏：</p>
<pre><code class="language-typescript">searchResult$
  .subscribe(result =&gt; {
    domUtils.fillSearchResult(result);
    domUtils.loaded();
  });
</code></pre>
<h1 id="錯誤處理">錯誤處理</h1>
<p>當查詢過程發生錯誤時，整條訂閱的 Observable 會完全中斷，這也代表如果中途產生無法處理的錯誤，會造成之後無法繼續進行查詢作業，為了避免這個問題，我們可以使用 <code>catchError()</code> 來攔截並處理錯誤：</p>
<pre><code class="language-typescript">searchResult$
  .pipe(
    // 處理搜尋事件的錯誤，以避免整個資料流從此中斷
    catchError(() =&gt; of([]))
  )
  .subscribe(result =&gt; {
    domUtils.fillSearchResult(result);
    domUtils.loaded();
  });
</code></pre>
<p>乍看之下沒什麼問題，當 <code>searchResult$</code> 發生錯誤時，攔截錯誤並給予空陣列，這樣便可以確保 <code>subscribe</code> 的 <code>next()</code> 可以收到資料，但 <code>catchError()</code> 回傳的 Observable 會讓目前訂閱的 Observable 剩下一個空陣列的資料然後結束，因此依然會讓整個訂閱結束，而導致無法繼續查詢。</p>
<p>這時候就要朝錯誤的源頭下手，也就是 <code>startSearch$.pipe(switchMap(...))</code> 內的 Observable，在這裡面進行錯誤處理，才不會讓整個 Observable 訂閱被結束，所以我們把查詢的程式拉出來，並加上錯誤處理機制：</p>
<pre><code class="language-typescript">const getSearchResult = (
  keyword: string,
  sort: string,
  order: string,
  page: number,
  perPage: number
) =&gt;
  dataUtils
    .getSearchResult(keyword, sort, order, page, perPage)
    .pipe(
      // 從查詢開始處理錯誤
      catchError(() =&gt; of([]))
    );
</code></pre>
<p>如此原來的 <code>searchResult$</code> 就不會有其他需要處理的錯誤，整個訂閱就不會因此而結束。</p>
<h1 id="顯示錯誤訊息">顯示錯誤訊息</h1>
<p>上個階段我們已經能處理錯誤了，但目前只是當錯誤發生時查不到資料而已，使用者感覺不出有錯誤發生，因此我們需要提示錯誤訊息，最簡單的方式是在 <code>catchError()</code> 內進行提示：</p>
<pre><code class="language-typescript">const getSearchResult = (
  keyword: string,
  sort: string,
  order: string,
  page: number,
  perPage: number
) =&gt;
  dataUtils
    .getSearchResult(keyword, sort, order, page, perPage)
    .pipe(
      // 從查詢開始處理錯誤
      catchError((error) =&gt; {
        alert(error.response.message);
        return of([]);
      })
    );
</code></pre>
<p>這樣依然會有 side effect 的問題，所以可以換個方式，把資料包裝起來，當錯誤發生時，加上一個錯誤的 flag：</p>
<pre><code class="language-typescript">const getSearchResult = (
  keyword: string,
  sort: string,
  order: string,
  page: number,
  perPage: number
) =&gt;
  dataUtils
    .getSearchResult(keyword, sort, order, page, perPage)
    .pipe(
      // 正常收到資料時，將資料包裝起來且 success 設成 true
      map(result =&gt; ({ success: true, message: null, data: result })),
      catchError((error) =&gt; {
        // 發生錯誤時，將資料包裝起來且 success 設成 false
        // 同時傳遞錯誤資訊，讓後續訂閱可以處理提示
        return of({
          success: false,
          message: error.response.message,
          data: []
        })
    }));
</code></pre>
<p>這麼一來就可以保留整個流程，直到 <code>subscribe</code> 時在進行處理，原來訂閱是直接拿 <code>result</code> 去更新，現在 <code>result</code> 變成包含是否成功資訊的物件，因此只要取其中的 <code>data</code> 來更新就好：</p>
<pre><code class="language-typescript">searchResult$.subscribe(result =&gt; {
  // 原來的 result 改變了，因此取其中的 data 就好
  // domUtils.fillSearchResult(result);
  domUtils.fillSearchResult(result.data);
  domUtils.loaded();
});
</code></pre>
<p>而處理錯誤的部分，我們可以拉出另外一條 Observable 來處理：</p>
<pre><code class="language-typescript">// 處理錯誤提示
searchResult$
  .pipe(
    filter(result =&gt; !result.success)
	).subscribe(result =&gt; {
    alert(result.message);
  });
</code></pre>
<p>把「顯示資料」和「錯誤處理」當作兩個不同的資料來源處理，可以讓我們在閱讀程式時更加專注在原本的意圖上。</p>
<p>這裡最後需要注意的是，<code>searchResult$</code> 因為針對不同情境處理而被訂閱了兩次，而原來的 <code>searchResult$</code> 是 Cold Observable，且其中有 <code>ajax</code> 的呼叫，代表每次訂閱都會重跑一次 <code>ajax</code>，這麼一來 API 呼叫就會重複，造成不必要的浪費，所以最後再 <code>searchResult$</code> 補上 <code>share()</code>：</p>
<pre><code class="language-typescript">const searchResult$ = startSearch$.pipe(
  switchMap(([keyword, sort, page, perPage]) =&gt;
    getSearchResult(keyword, sort.sort, sort.order, page, perPage)
  ),
  // searchResult$ 有多次訂閱
  // 因此使用 share 避免重複請求資料
  share()
);
</code></pre>
<p></p><div class="note info"><p>在前面 <code>keyword$</code> 示範時使用 <code>shareReplay(1)</code> 是因為訂閱時機會隨著按鈕事件的 <code>switchMap()</code> 訂閱時間而不同，且需要最後一次事件的資訊。</p>
<p>在這裡使用 <code>share()</code> 則是因為訂閱會立刻發生，且沒有使用最後一次事件資訊需要的關係；當然，要在這裡使用 <code>shareReplay(1)</code> 在邏輯上也是完全沒問題的。</p></div><p>
</p><h1 id="本日小結">本日小結</h1>
<p>今天我們透過實際在網頁程式上常常遇到的查詢、分頁和排序等功能，來說明實務上 RxJS 的應用，以及各種 operators 的組合技巧。</p>
<p>當所有事件都使用資料流及 Observable 的觀點來思考時，整個思路會變得更加單純，我們只需要習慣應用各種已經學會的 operators 來組合這些資料流即可，而且每個資料流、每個訂閱都只處理自己該做的事情，讓每段程式碼都變得更簡短好閱讀，且發生問題時，也可以很容易從問題發生點循序找到每個執行過程，更容易找到錯誤發生的地方！</p>
<p>剛開始在學習 RxJS 時一定會對於何時該使用哪些 operators 的問題覺得不知所措，建議可以多加練習，把上述的程式碼反覆寫過，了解每個資料的流向，接著更可以嘗試組合不同的 operators，用不同的寫法達到一樣的功能，久而久之習慣後，RxJS 功力就會大增囉！！</p>
</div><div _ngcontent-sc131="" class="blog-post-tags"><mat-chip-list _ngcontent-sc131="" aria-label="Post Tags" class="mat-chip-list" id="mat-chip-list-25" tabindex="0" aria-required="false" aria-disabled="false" aria-invalid="false" aria-multiselectable="false" role="listbox" aria-orientation="horizontal"><div class="mat-chip-list-wrapper"><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> RxJS </mat-chip><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> ajax </mat-chip><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> map </mat-chip><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> switchMap </mat-chip><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> debounceTime </mat-chip><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> distinctUntilChanged </mat-chip><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> share </mat-chip><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> shareReplay </mat-chip><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> filter </mat-chip><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> take </mat-chip><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> startWith </mat-chip><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> catchError </mat-chip><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> mapTo </mat-chip><mat-chip _ngcontent-sc131="" role="option" color="primary" selected="" class="mat-chip mat-focus-indicator blog-post-tag mat-primary mat-standard-chip mat-chip-selected _mat-animation-noopable ng-star-inserted" tabindex="-1" aria-disabled="false" aria-selected="true"><div class="mat-chip-ripple"></div> scan </mat-chip><!----></div></mat-chip-list></div><mat-divider _ngcontent-sc131="" role="separator" class="mat-divider mat-divider-horizontal" aria-orientation="horizontal"></mat-divider><div _ngcontent-sc131="" class="blog-post-prev-next"><div _ngcontent-sc131="" class="blog-post-prev"><div _ngcontent-sc131="" class="blog-post-prev-next-notify prev ng-star-inserted"><mat-icon _ngcontent-sc131="" role="img" class="mat-icon notranslate material-icons mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font">chevron_left</mat-icon> 上一篇 </div><a _ngcontent-sc131="" href="/blog/2020/10/16/mastering-rxjs-30-multicast-publish-refcount-share-sharereplay" class="ng-star-inserted"> [RxJS] Multicast 類 Operator (1) - multicast / publish / refCount / share / shareReplay </a><!----><!----><!----></div><div _ngcontent-sc131="" class="blog-post-next"><div _ngcontent-sc131="" class="blog-post-prev-next-notify next ng-star-inserted"> 下一篇 <mat-icon _ngcontent-sc131="" role="img" class="mat-icon notranslate material-icons mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font">chevron_right</mat-icon></div><a _ngcontent-sc131="" href="/blog/2020/10/18/mastering-rxjs-32-implement-flux-pattern-with-rxjs" class="ng-star-inserted"> [RxJS] 實戰練習 - 使用 RxJS 實作 Flux Pattern </a><!----><!----><!----></div><!----></div><mat-divider _ngcontent-sc131="" role="separator" class="mat-divider mat-divider-horizontal" aria-orientation="horizontal"></mat-divider><h1 _ngcontent-sc131="">有任何問題或建議嗎？歡迎留言給我</h1><div _ngcontent-sc131="" class="blog-post-comments"></div></div><!----></div><!----><!----></app-blog-post><!----><button _ngcontent-sc87="" mat-fab="" color="default" mattooltip="回到最上面" class="mat-focus-indicator go-top mat-fab mat-button-base mat-default _mat-animation-noopable"><span class="mat-button-wrapper"><mat-icon _ngcontent-sc87="" role="img" class="mat-icon notranslate material-icons mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font">keyboard_double_arrow_up</mat-icon></span><span matripple="" class="mat-ripple mat-button-ripple mat-button-ripple-round"></span><span class="mat-button-focus-overlay"></span></button></div></app-blog-layout><!----></mat-drawer-content><!----></mat-drawer-container></app-root>
<script src="runtime.7ff58c590f5487bde224.js" defer=""></script><script src="polyfills.145163af39e593267dd4.js" defer=""></script><script src="main.4dee6e8b23e793363d55.js" defer=""></script>


</body><!-- This page was prerendered with Angular Universal --></html>